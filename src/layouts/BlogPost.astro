---
import type { CollectionEntry } from "astro:content";
import "@/styles/article.css";
import Layout from "./Layout.astro";
import toc from "markdown-toc";
import { marked } from "marked";
import ArticleInfo from "@/components/ArticleInfo.astro";
import Icon from "astro-icon";

type Props = CollectionEntry<"blog">["data"];
const { post } = Astro.props;
const { title, description, heroImage, tags } = post.data;
const toc_html = marked.parse(toc(post.body, { maxdepth: 2 }).content);
---

<Layout title={title} description={description}>
  <main id="main">
    <article>
      <div class="title">
        <h1>{title}</h1>
        <!-- <hr /> -->
      </div>
      {
        toc_html && (
          <details>
            <summary>目录</summary>
            <div class="toc" set:html={toc_html} />
          </details>
        )
      }
      <slot name="content" />
      <hr>
      <ArticleInfo slug={post.slug} {...post.data} />
      {
        tags && (
          <div class="tags">
            <Icon name="ri:hashtag" />
            {tags.map((tag) => (
              <a class="tag" href={`/tags/${tag}`}>
                {tag}
              </a>
            ))}
          </div>
        )
      }
    </article>
  </main>
</Layout>
